<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="https://vnpt.com.vn/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0068FF" />
    <meta name="description" content="Kho Sim Phong Thủy, Sim Số Đẹp Vinaphone" />
    <title>VNPT Sim Phong Thủy - Sim Số Đẹp</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              vnpt: {
                primary: '#0068FF',
                secondary: '#2B80FF',
                light: '#E6F0FF',
                accent: '#FFD700',
              }
            },
            animation: {
              'fade-in': 'fadeIn 0.5s ease-out',
              'fade-in-up': 'fadeInUp 0.5s ease-out',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' },
              },
              fadeInUp: {
                '0%': { opacity: '0', transform: 'translateY(10px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              }
            }
          }
        }
      }
    </script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
      body { font-family: 'Roboto', sans-serif; }
      .loader { border: 4px solid #f3f3f3; border-top: 4px solid #0068FF; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>

    <!-- Error Trap -->
    <script>
      window.onerror = function(message, source, lineno, colno, error) {
        const root = document.getElementById('root');
        if (root) {
          root.innerHTML = `
            <div style="padding: 20px; text-align: center; color: #721c24; background-color: #f8d7da; margin: 20px; border-radius: 8px; font-family: sans-serif;">
              <h2 style="margin: 0 0 10px 0;">Ứng dụng gặp lỗi khởi động!</h2>
              <p><strong>Lỗi:</strong> ${message}</p>
              <p>Vui lòng kiểm tra Console (F12) để biết chi tiết.</p>
            </div>
          `;
        }
        console.error("CRITICAL ERROR:", error);
      };

      // Polyfill process.env
      window.process = {
        env: {
          NODE_ENV: 'production',
          API_KEY: '', // Điền API Key Google Gemini
          FIREBASE_API_KEY: '' // Điền API Key Firebase
        }
      };
    </script>

    <!-- Import Map: Đã xóa các dòng conflict phiên bản -->
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "react-router-dom": "https://esm.sh/react-router-dom@6.22.0?deps=react@18.2.0,react-dom@18.2.0",
    "@google/genai": "https://esm.sh/@google/genai@0.1.1",
    "firebase/app": "https://esm.sh/firebase@10.8.0/app",
    "firebase/firestore": "https://esm.sh/firebase@10.8.0/firestore",
    "lucide-react": "https://esm.sh/lucide-react@0.330.0?deps=react@18.2.0",
    "firebase/": "https://esm.sh/firebase@^12.9.0/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>

    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root">
      <div style="height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center;">
        <div class="loader"></div>
        <p style="color: #0068FF; font-family: sans-serif; margin-top: 10px;">Đang tải VNPT Sim...</p>
      </div>
    </div>

    <!-- MAIN APP SCRIPT -->
    <script type="text/babel" data-type="module" data-presets="typescript,react">
      import React, { useState, useEffect } from 'react';
      import ReactDOM from 'react-dom/client';
      import { HashRouter as Router, Routes, Route, Link, useLocation } from 'react-router-dom';
      import { Phone, Menu, ShieldCheck, ShoppingCart, Star, Search, Filter, Sparkles, X, Shield, Package, CheckCircle, XCircle, Clock, ArrowRight } from 'lucide-react';
      import { GoogleGenAI, Type } from "@google/genai";
      import { initializeApp } from 'firebase/app';
      import { getFirestore, collection, getDocs, addDoc, updateDoc, doc, query, orderBy, where } from 'firebase/firestore';

      // --- 1. MOCK DATA & CONFIG ---
      
      const MOCK_SIMS = [
        { id: '1', phoneNumber: '0912.345.678', price: 5000000, provider: 'Vinaphone', category: ['Sảnh Tiến', 'Phong Thủy'], status: 'available', score: 9.5 },
        { id: '2', phoneNumber: '0918.888.999', price: 15000000, provider: 'Vinaphone', category: ['Tam Hoa', 'Lộc Phát'], status: 'available', score: 9.8 },
        { id: '3', phoneNumber: '0919.39.79.39', price: 2500000, provider: 'Vinaphone', category: ['Thần Tài'], status: 'available', score: 8.5 },
        { id: '4', phoneNumber: '0888.666.888', price: 8000000, provider: 'Vinaphone', category: ['Tam Hoa', 'Kép'], status: 'available', score: 9.0 },
        { id: '5', phoneNumber: '0915.11.02.02', price: 1200000, provider: 'Vinaphone', category: ['Năm Sinh', 'Dễ Nhớ'], status: 'available', score: 7.5 },
        { id: '6', phoneNumber: '0945.678.910', price: 9000000, provider: 'Vinaphone', category: ['Sảnh Rồng'], status: 'sold', score: 9.9 },
        { id: '7', phoneNumber: '0911.22.33.44', price: 3000000, provider: 'Vinaphone', category: ['Taxi', 'Lặp'], status: 'available', score: 8.0 },
        { id: '8', phoneNumber: '0833.555.777', price: 4500000, provider: 'Vinaphone', category: ['Tam Hoa'], status: 'available', score: 8.2 },
      ];

      // Setup Firebase
      const firebaseConfig = {
        apiKey: process.env.FIREBASE_API_KEY,
        authDomain: "vnpt-sim-phong-thuy.firebaseapp.com",
        projectId: "vnpt-sim-phong-thuy",
        storageBucket: "vnpt-sim-phong-thuy.appspot.com",
        messagingSenderId: "123456789",
        appId: "1:123456789:web:abcdef"
      };

      // Tự động chuyển sang Mock nếu không có API Key
      const USE_MOCK = !firebaseConfig.apiKey; 
      let db;
      if (!USE_MOCK) {
        try {
          const app = initializeApp(firebaseConfig);
          db = getFirestore(app);
        } catch(e) { console.warn("Firebase Init Error, using Mock"); }
      }

      // --- 2. SERVICES ---

      const getSims = async () => {
        if (USE_MOCK || !db) return MOCK_SIMS;
        try {
          const q = query(collection(db, 'sims'), where('status', '==', 'available'));
          const snapshot = await getDocs(q);
          return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        } catch (e) { return MOCK_SIMS; }
      };

      const createOrder = async (order) => {
        const newOrder = { ...order, status: 'new', createdAt: Date.now() };
        if (USE_MOCK || !db) return "mock-id-" + Date.now();
        const docRef = await addDoc(collection(db, 'orders'), newOrder);
        return docRef.id;
      };

      const getOrders = async () => {
        if (USE_MOCK || !db) {
          return [
            { id: '101', simId: '1', phoneNumber: '0912.345.678', price: 5000000, customerName: 'Nguyễn Văn A', customerPhone: '0909000000', address: 'Hà Nội', status: 'new', createdAt: Date.now() - 86400000 },
            { id: '102', simId: '3', phoneNumber: '0919.39.79.39', price: 2500000, customerName: 'Trần Thị B', customerPhone: '0909111222', address: 'TP.HCM', status: 'completed', createdAt: Date.now() - 172800000 },
          ];
        }
        const q = query(collection(db, 'orders'), orderBy('createdAt', 'desc'));
        const snapshot = await getDocs(q);
        return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
      };

      const updateOrderStatus = async (id, status) => {
        if (USE_MOCK || !db) return;
        await updateDoc(doc(db, 'orders', id), { status });
      };

      const analyzeSimFengShui = async (phoneNumber, birthYear, gender) => {
        const apiKey = process.env.API_KEY;
        if (!apiKey) {
          return new Promise(resolve => setTimeout(() => resolve({
            score: 8.5,
            element: "Kim",
            interpretation: "Sim này mang lại sự cân bằng, tài lộc ổn định. (Chế độ Demo - Hãy nhập API Key trong code để xem thật).",
            compatibility: "Hợp với người mệnh Thủy và Thổ."
          }), 1500));
        }

        const ai = new GoogleGenAI({ apiKey });
        const prompt = `Đóng vai chuyên gia phong thủy. Phân tích sim ${phoneNumber} cho người sinh năm ${birthYear}, giới tính ${gender}. Trả về JSON: score (số 1-10), element (ngũ hành), interpretation (lời bình), compatibility (hợp mệnh).`;

        try {
          const response = await ai.models.generateContent({
            model: "gemini-3-flash-preview",
            contents: prompt,
            config: {
              responseMimeType: "application/json",
              responseSchema: {
                type: Type.OBJECT,
                properties: {
                  score: { type: Type.NUMBER },
                  element: { type: Type.STRING },
                  interpretation: { type: Type.STRING },
                  compatibility: { type: Type.STRING },
                }
              }
            }
          });
          return JSON.parse(response.text);
        } catch (error) {
          return { score: 5, element: "N/A", interpretation: "Lỗi kết nối AI.", compatibility: "N/A" };
        }
      };

      // --- 3. COMPONENTS ---

      const SimItem = ({ sim, onBuy, onAnalyze }) => {
        const formatPrice = (p) => new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(p);
        return (
          <div className="bg-white rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 border border-gray-100 overflow-hidden flex flex-col">
            <div className="p-4 bg-vnpt-light border-b border-gray-200 text-center">
              <h3 className="text-2xl font-bold text-vnpt-primary tracking-wide">{sim.phoneNumber}</h3>
              <div className="mt-1 flex justify-center space-x-2">
                 {sim.category.map((cat, idx) => (
                   <span key={idx} className="text-xs bg-white text-vnpt-secondary px-2 py-0.5 rounded-full border border-blue-200">{cat}</span>
                 ))}
              </div>
            </div>
            <div className="p-4 flex-grow flex flex-col justify-between">
              <div className="mb-4 text-center">
                <p className="text-xl font-bold text-red-600">{formatPrice(sim.price)}</p>
                {sim.score && (
                  <div className="flex items-center justify-center mt-2 text-yellow-500 font-medium">
                    <Star className="w-4 h-4 fill-current mr-1" />
                    <span>{sim.score}/10 Phong Thủy</span>
                  </div>
                )}
              </div>
              <div className="grid grid-cols-2 gap-2 mt-auto">
                <button onClick={() => onAnalyze(sim)} className="px-3 py-2 text-sm text-vnpt-secondary bg-white border border-vnpt-secondary rounded hover:bg-blue-50 transition-colors flex items-center justify-center">
                  <Star className="w-4 h-4 mr-1" /> Xem P.Thủy
                </button>
                <button onClick={() => onBuy(sim)} className="px-3 py-2 text-sm text-white bg-vnpt-primary rounded hover:bg-blue-700 transition-colors flex items-center justify-center shadow-lg shadow-blue-200">
                  <ShoppingCart className="w-4 h-4 mr-1" /> Đặt Mua
                </button>
              </div>
            </div>
          </div>
        );
      };

      const Layout = ({ children }) => {
        const location = useLocation();
        const isAdmin = location.pathname.includes('admin');
        return (
          <div className="min-h-screen flex flex-col bg-slate-50">
            <header className="bg-vnpt-primary text-white shadow-lg sticky top-0 z-50">
              <div className="container mx-auto px-4 py-3">
                <div className="flex justify-between items-center">
                  <Link to="/" className="flex items-center space-x-2 group">
                    <div className="bg-white p-1.5 rounded-full group-hover:rotate-12 transition-transform">
                      <Phone className="w-6 h-6 text-vnpt-primary" />
                    </div>
                    <div className="flex flex-col">
                      <span className="text-xl font-bold tracking-tighter leading-none">VNPT SIM</span>
                      <span className="text-xs text-blue-200 tracking-widest uppercase">Phong Thủy</span>
                    </div>
                  </Link>
                  <nav className="hidden md:flex space-x-6 font-medium">
                    <Link to="/" className="hover:text-yellow-300 transition-colors">Trang Chủ</Link>
                    <Link to="/feng-shui" className="hover:text-yellow-300 transition-colors">Công Cụ Phong Thủy</Link>
                  </nav>
                  <div className="flex items-center space-x-4">
                    <a href="tel:18001091" className="hidden lg:flex items-center bg-white/10 px-3 py-1 rounded-full text-sm font-semibold hover:bg-white/20">
                      <Phone className="w-4 h-4 mr-2" /> Hotline: 1800 1091
                    </a>
                    {!isAdmin && (
                      <Link to="/admin" className="text-sm opacity-60 hover:opacity-100 flex items-center">
                        <ShieldCheck className="w-4 h-4 mr-1" /> Admin
                      </Link>
                    )}
                  </div>
                </div>
              </div>
            </header>
            <main className="flex-grow container mx-auto px-4 py-6">{children}</main>
            <footer className="bg-slate-900 text-slate-300 py-8">
              <div className="container mx-auto px-4 text-center">
                <p>&copy; 2024 VNPT Sim Phong Thủy</p>
                <p className="text-xs mt-2 text-slate-500">Thiết kế hệ thống bởi Gemini Senior Engineer</p>
              </div>
            </footer>
          </div>
        );
      };

      // --- 4. PAGES ---

      const AdminPage = () => {
        const [auth, setAuth] = useState(false);
        const [user, setUser] = useState('');
        const [pass, setPass] = useState('');
        const [orders, setOrders] = useState([]);
        const [loading, setLoading] = useState(false);

        const login = (e) => {
          e.preventDefault();
          if (user === 'admin' && pass === 'admin') {
            setAuth(true);
            fetchOrders();
          } else alert('Sai thông tin! (admin/admin)');
        };

        const fetchOrders = async () => {
          setLoading(true);
          setOrders(await getOrders());
          setLoading(false);
        };

        const update = async (id, st) => {
          await updateOrderStatus(id, st);
          fetchOrders();
        };

        const badge = (st) => {
          if (st === 'new') return <span className="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-bold">Mới</span>;
          if (st === 'processing') return <span className="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full font-bold">Xử lý</span>;
          if (st === 'completed') return <span className="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full font-bold">Xong</span>;
          return <span className="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">Hủy</span>;
        };

        if (!auth) return (
          <div className="flex justify-center items-center h-[50vh]">
            <form onSubmit={login} className="bg-white p-8 shadow-lg rounded-lg border-t-4 border-vnpt-primary w-full max-w-sm">
              <h2 className="text-2xl font-bold mb-4 text-center">Đăng Nhập Admin</h2>
              <input className="w-full border p-2 rounded mb-3" placeholder="Tài khoản" value={user} onChange={e=>setUser(e.target.value)} />
              <input className="w-full border p-2 rounded mb-4" type="password" placeholder="Mật khẩu" value={pass} onChange={e=>setPass(e.target.value)} />
              <button className="w-full bg-vnpt-primary text-white py-2 rounded font-bold">Vào Hệ Thống</button>
            </form>
          </div>
        );

        return (
          <div>
            <div className="flex justify-between mb-4">
              <h1 className="text-2xl font-bold">Quản Lý Đơn Hàng</h1>
              <button onClick={fetchOrders} className="bg-gray-200 px-3 py-1 rounded">Làm mới</button>
            </div>
            {loading ? <div>Đang tải...</div> : (
              <div className="bg-white shadow rounded overflow-x-auto">
                <table className="w-full text-sm text-left">
                  <thead className="bg-gray-50 uppercase text-xs">
                    <tr><th className="px-6 py-3">Mã</th><th className="px-6 py-3">Sim</th><th className="px-6 py-3">Khách</th><th className="px-6 py-3">Trạng thái</th><th className="px-6 py-3 text-right">Thao tác</th></tr>
                  </thead>
                  <tbody>
                    {orders.map(o => (
                      <tr key={o.id} className="border-b">
                        <td className="px-6 py-4">{o.id}</td>
                        <td className="px-6 py-4 font-bold text-vnpt-primary">{o.phoneNumber}</td>
                        <td className="px-6 py-4">
                          <div>{o.customerName}</div>
                          <div className="text-xs text-gray-500">{o.customerPhone}</div>
                        </td>
                        <td className="px-6 py-4">{badge(o.status)}</td>
                        <td className="px-6 py-4 text-right">
                          {o.status === 'new' && <button onClick={()=>update(o.id,'processing')} className="text-yellow-600 mr-2 hover:underline">Xử lý</button>}
                          {o.status === 'processing' && <button onClick={()=>update(o.id,'completed')} className="text-green-600 hover:underline">Hoàn tất</button>}
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            )}
          </div>
        );
      };

      const FengShuiPage = () => {
        const [ph, setPh] = useState('');
        const [y, setY] = useState('');
        const [g, setG] = useState('Nam');
        const [res, setRes] = useState(null);
        const [load, setLoad] = useState(false);

        const run = async (e) => {
          e.preventDefault();
          setLoad(true);
          setRes(await analyzeSimFengShui(ph, y, g));
          setLoad(false);
        };

        return (
          <div className="max-w-4xl mx-auto grid md:grid-cols-2 gap-8">
            <div className="bg-white p-6 rounded shadow border-t-4 border-vnpt-primary">
              <h2 className="text-2xl font-bold mb-4">AI Phong Thủy</h2>
              <form onSubmit={run} className="space-y-4">
                <input className="w-full border p-2 rounded" placeholder="Số điện thoại" value={ph} onChange={e=>setPh(e.target.value)} required />
                <div className="grid grid-cols-2 gap-4">
                  <input className="border p-2 rounded" type="number" placeholder="Năm sinh" value={y} onChange={e=>setY(e.target.value)} required />
                  <select className="border p-2 rounded" value={g} onChange={e=>setG(e.target.value)}><option>Nam</option><option>Nữ</option></select>
                </div>
                <button disabled={load} className="w-full bg-vnpt-primary text-white py-2 rounded font-bold">{load ? 'Đang tính...' : 'Xem Kết Quả'}</button>
              </form>
            </div>
            <div className="bg-white p-6 rounded shadow">
              {res ? (
                <div className="text-center animate-fade-in">
                  <div className="text-5xl font-bold text-red-600 mb-2">{res.score}/10</div>
                  <p className="font-bold text-lg text-blue-800 mb-4">{res.element}</p>
                  <div className="text-left bg-gray-50 p-3 rounded mb-2 text-sm">{res.interpretation}</div>
                  <div className="text-left bg-green-50 p-3 rounded text-sm">{res.compatibility}</div>
                </div>
              ) : <div className="text-center text-gray-400 py-10">Kết quả sẽ hiện ở đây</div>}
            </div>
          </div>
        );
      };

      const HomePage = () => {
        const [sims, setSims] = useState([]);
        const [filter, setFilter] = useState([]);
        const [term, setTerm] = useState('');
        const [sel, setSel] = useState(null);
        const [modal, setModal] = useState(''); 
        const [form, setForm] = useState({ name: '', phone: '', addr: '' });
        const [orderSt, setOrderSt] = useState('idle');
        const [fsData, setFsData] = useState({ year: '', gender: 'Nam', res: null, load: false });

        useEffect(() => {
          getSims().then(data => { setSims(data); setFilter(data); });
        }, []);

        useEffect(() => {
          setFilter(sims.filter(s => s.phoneNumber.replace(/\./g,'').includes(term.replace(/\./g,''))));
        }, [term, sims]);

        const buy = async (e) => {
          e.preventDefault();
          setOrderSt('load');
          await createOrder({ simId: sel.id, phoneNumber: sel.phoneNumber, price: sel.price, customerName: form.name, customerPhone: form.phone, address: form.addr });
          setOrderSt('done');
          setTimeout(() => { setModal(''); setOrderSt('idle'); setForm({name:'',phone:'',addr:''}); }, 2000);
        };

        const analyze = async () => {
          setFsData(p => ({...p, load: true}));
          const res = await analyzeSimFengShui(sel.phoneNumber, fsData.year, fsData.gender);
          setFsData(p => ({...p, load: false, res}));
        };

        return (
          <div className="space-y-8">
            <div className="bg-gradient-to-r from-vnpt-primary to-vnpt-secondary text-white p-8 rounded-2xl shadow-lg text-center">
              <h1 className="text-3xl font-bold mb-4">Tìm Sim Số Đẹp VNPT</h1>
              <div className="bg-white p-2 rounded max-w-xl mx-auto flex">
                <input className="flex-grow p-2 text-black outline-none" placeholder="Nhập số sim (ví dụ: 091)..." value={term} onChange={e=>setTerm(e.target.value)} />
                <button className="bg-vnpt-accent text-blue-900 font-bold px-4 rounded">Tìm</button>
              </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
              {filter.map(s => (
                <SimItem key={s.id} sim={s} 
                  onBuy={() => { setSel(s); setModal('buy'); }} 
                  onAnalyze={() => { setSel(s); setModal('analysis'); setFsData({year:'', gender:'Nam', res:null, load:false}); }} 
                />
              ))}
            </div>

            {modal === 'buy' && sel && (
              <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                <div className="bg-white p-6 rounded-lg max-w-md w-full animate-fade-in-up">
                  <div className="flex justify-between mb-4"><h3 className="font-bold text-lg">Mua Sim {sel.phoneNumber}</h3><button onClick={()=>setModal('')}><X/></button></div>
                  {orderSt === 'done' ? <div className="text-green-600 text-center font-bold py-4">Đặt hàng thành công!</div> : (
                    <form onSubmit={buy} className="space-y-3">
                      <div className="text-center font-bold text-red-600 text-xl mb-4">{new Intl.NumberFormat('vi-VN').format(sel.price)}đ</div>
                      <input required className="w-full border p-2 rounded" placeholder="Họ tên" value={form.name} onChange={e=>setForm({...form, name:e.target.value})} />
                      <input required className="w-full border p-2 rounded" placeholder="Số điện thoại" value={form.phone} onChange={e=>setForm({...form, phone:e.target.value})} />
                      <input className="w-full border p-2 rounded" placeholder="Địa chỉ" value={form.addr} onChange={e=>setForm({...form, addr:e.target.value})} />
                      <button className="w-full bg-vnpt-primary text-white py-2 rounded font-bold" disabled={orderSt === 'load'}>{orderSt === 'load' ? 'Đang gửi...' : 'Xác Nhận'}</button>
                    </form>
                  )}
                </div>
              </div>
            )}

            {modal === 'analysis' && sel && (
              <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                <div className="bg-white p-6 rounded-lg max-w-md w-full animate-fade-in-up max-h-[90vh] overflow-y-auto">
                  <div className="flex justify-between mb-4"><h3 className="font-bold text-lg text-purple-700">Phong Thủy {sel.phoneNumber}</h3><button onClick={()=>setModal('')}><X/></button></div>
                  {!fsData.res ? (
                    <div className="space-y-4">
                      <input className="w-full border p-2 rounded" type="number" placeholder="Năm sinh (VD: 1990)" value={fsData.year} onChange={e=>setFsData({...fsData, year:e.target.value})} />
                      <select className="w-full border p-2 rounded" value={fsData.gender} onChange={e=>setFsData({...fsData, gender:e.target.value})}><option>Nam</option><option>Nữ</option></select>
                      <button onClick={analyze} disabled={!fsData.year || fsData.load} className="w-full bg-purple-600 text-white py-2 rounded font-bold">{fsData.load ? 'Đang luận...' : 'Xem Phong Thủy'}</button>
                    </div>
                  ) : (
                    <div className="space-y-2">
                      <div className="text-center text-4xl font-bold text-red-600">{fsData.res.score}/10</div>
                      <p><strong>Mạng:</strong> {fsData.res.element}</p>
                      <div className="bg-gray-50 p-2 text-sm rounded">{fsData.res.interpretation}</div>
                      <div className="bg-green-50 p-2 text-sm rounded"><strong>Lời khuyên:</strong> {fsData.res.compatibility}</div>
                      <button onClick={()=>setFsData({...fsData, res:null})} className="text-sm text-center w-full text-blue-600 mt-2">Xem lại</button>
                    </div>
                  )}
                </div>
              </div>
            )}
          </div>
        );
      };

      const App = () => (
        <Router>
          <Layout>
            <Routes>
              <Route path="/" element={<HomePage />} />
              <Route path="/admin" element={<AdminPage />} />
              <Route path="/feng-shui" element={<FengShuiPage />} />
            </Routes>
          </Layout>
        </Router>
      );

      // Mount App
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<React.StrictMode><App /></React.StrictMode>);
    </script>
  </body>
</html>